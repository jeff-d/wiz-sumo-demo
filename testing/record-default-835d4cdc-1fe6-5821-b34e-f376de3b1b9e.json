{
  "fields": {
    "resource.subscriptionName": "jdsumo",
    "issue.severity": "CRITICAL",
    "issue.id": "1d4fe952-6fc1-4483-b866-423d66eb8af1",
    "control.name": "Application endpoint with an unauthenticated API on a VM/serverless exposes secrets",
    "issue.evidence.1.2.externalId": "http://ec2-34-215-221-195.us-west-2.compute.amazonaws.com:80/",
    "control.id": "wc-id-1185",
    "resource.id": "arn:aws:ec2:us-west-2:680721692967:instance/i-03400b91140af947b",
    "trigger.ruleName": "Manual",
    "resource.type": "virtualMachine",
    "trigger.source": "ISSUE",
    "issue.evidence.1.2.name": "http://ec2-34-215-221-195.us-west-2.compute.amazonaws.com:80",
    "issue.evidence.1.3.snippet": "\\\"AKIAZ47RMXET6WIZSUMO\\\",\\\\n  \\\"aws_secret_access_key\\\": \\\"---REDACTED---\\\",",
    "control.description": "This resource exposes an unauthenticated API to the public internet in HTTP, and its HTTP GET response contains secrets in cleartext. \n\nPublicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that sends an HTTP GET request to this application endpoint can compromise the secret.",
    "resource.subscriptionId": "680721692967",
    "issue.evidence.1.1.externalId": "i-03400b91140af947b",
    "resource.cloudPlatform": "AWS",
    "issue.evidence.1.3.lineNumber": "3",
    "issue.evidence.1.1.name": "quicklab-rqcg-linux-q3ms1k",
    "resource.status": "Active",
    "issue.evidence.1.3.path": "http://ec2-34-215-221-195.us-west-2.compute.amazonaws.com:80",
    "resource.region": "us-west-2",
    "resource.cloudProviderURL": "https://us-west-2.console.aws.amazon.com/ec2/v2/home?region=us-west-2#InstanceDetails:instanceId=i-03400b91140af947b",
    "issue.created": "2023-12-07T03:51:44.747849Z",
    "issue.projects": "WizSumoEvent,",
    "issue.evidence.1.1.EvidenceObjectType": "VIRTUAL_MACHINE",
    "issue.evidence.1.2.EvidenceObjectType": "ENDPOINT",
    "issue.status": "OPEN",
    "resource.name": "quicklab-rqcg-linux-q3ms1k",
    "issue.evidence.1.3.EvidenceObjectType": "SECRET_INSTANCE",
    "issue.evidence.1.3.name": "AWS Secret Key (AccessKeyId=AKIAZ47RMXET6WIZSUMO)"
  },
  "accountId": "680721692967",
  "cloud_provider": "AWS",
  "cloud_region": "us-west-2",
  "description": "This resource exposes an unauthenticated API to the public internet in HTTP, and its HTTP GET response contains secrets in cleartext. \n\nPublicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that sends an HTTP GET request to this application endpoint can compromise the secret.",
  "fieldTags": {},
  "http_requestHeaders": {},
  "listMatches": [],
  "matchedItems": [],
  "metadata_deviceEventId": "",
  "metadata_mapperName": "Wiz Catch All",
  "metadata_mapperUid": "e741e5da-3798-4033-a377-8332e1462898",
  "metadata_orgId": "0000000000BD582E",
  "metadata_parseTime": 1703003490573,
  "metadata_parser": "/Parsers/System/Wiz/Wiz",
  "metadata_product": "Wiz",
  "metadata_productGuid": "52ac893d-bdf9-4e2c-be83-5f43842a179d",
  "metadata_sensorZone": "default",
  "metadata_sourceCategory": "wiz",
  "metadata_sourceMessageId": "6772441668006165544",
  "metadata_vendor": "Wiz",
  "normalizedSeverity": 9,
  "objectClassification": "Endpoint",
  "objectType": "Endpoint",
  "resource": "quicklab-rqcg-linux-q3ms1k",
  "resourceType": "virtualMachine",
  "severity": "CRITICAL",
  "threat_ruleType": "direct",
  "threat_signalName": "Application endpoint with an unauthenticated API on a VM/serverless exposes secrets",
  "threat_signalSummary": "This resource exposes an unauthenticated API to the public internet in HTTP, and its HTTP GET response contains secrets in cleartext. \n\nPublicly exposed resources are more easily accessible for an attacker than internal ones. Moreover, cleartext cloud keys pose a serious security risk, as they allow lateral movement within your environment. An attacker that sends an HTTP GET request to this application endpoint can compromise the secret.",
  "timestamp": 1701921104747,
  "uid": "835d4cdc-1fe6-5821-b34e-f376de3b1b9e",
  "_type": "Endpoint"
}